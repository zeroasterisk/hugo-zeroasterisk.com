<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta name="generator" content="Hugo 0.20.7" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Beforesave | Alan Blount &amp; Family | zeroasterisk</title>

     
      
    
    
    
      <meta name="robots" content="noindex">
    
    
    

  <meta name="author" content="">

 
    <meta property="og:title" content="Beforesave" />
<meta property="og:description" content="alan&#39;s personal blog and website: family, friends, whatever" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://zeroasterisk.com/tags/beforesave/" />



<meta property="og:updated_time" content="2010-02-19T02:59:45&#43;00:00"/>









 
    

  <meta property="og:image" content="https://en.gravatar.com/userimage/831761/080d157cba7201fa2d89172617f6b7bb.jpg?size=200">



 
    
     
    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-2011466-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>
 
    
    <link href="https://zeroasterisk.com/tags/beforesave/index.xml" rel="alternate" type="application/rss+xml" title="Alan Blount &amp; Family | zeroasterisk" /> 
    
    <link rel="canonical" href="https://zeroasterisk.com/tags/beforesave/">   <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABwlBMVEUAAAA/3MUK07UJ0rRk6NkC0rMAw5sAx6Ic1rs/3MYAlU0E0rQAhjMAyKIAiTkM07UJ07UAhC8m2L4o2L5O4Msn2L4AzKoAzq0128Mo2b8F0rQE0rMu2cAt2cAA0bI228MA0LAAy6kr2b8Q1LcF0rMH0rUAxp4t2b8c1ros2b8P1LcAzKsAzq4528Q02sIM07YAfyg93cUD0rMA0LEA0bFK4c0M1LcL07Uv2sEAzawY1rlJ4c0w2sEAzKkY1rqr+PQN07Yj170G0rQI07UF0bMt2cAF0rMC0bIL07UF0bMs2cAF0rMA0bIC0bIL07UF0rMA0bIA0bIA0bIO1LYr2b8N07Yp2L4F0rMF0rQJ07UA0bIC0bMA0bIH0rQK07UD0bMA0LAF0rMAyqYE0rMA0bIS1Lg228ID0bMM07YS1LcI07QL07UJ07UC0bMM07YG0rMS1Lc328IR1LcC0bIK07UM07Yo2L4P1LcL07UD0rMD0rMD0rMB0bIH0rQ23MMQ1LcD0rMN1LYB0LAJ0rQ33MMG0bMP1bgD0rMN07YH0rQH0rQ33MQF0rMD0rMN1LYo2L4F0rQG0rSA6tsA0bIB0bL////yxqscAAAAk3RSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgnDXAUItvZKBAi6+vpMuf3++wEIAQcEBFn5AgR9UwMEoQLD/AEH4AIdAzha+UMEAQcc9AM4CAFSA9IC+4AEAc8yAwIEBAHOMQOBBLfLMAnFlAJNsa0LAAAAAWJLR0SVCGB6gwAAAAd0SU1FB+EBBBI4BduZ4woAAAF5SURBVDjLY2CAAUYmZgcWRydnVhc2dg4GTMAJlOdydZvs7sHtiU0FSJ7Hy3uyz2RfP24XNl4OLPJ8Xv5A+YBAsAo0M2DyQZMnY1fBL+AgCJXHrkIoWDgEJo9NhUioaBhCHqoiXExcAqZAMkIqckrU5MkoKqSjZeAmyMbIxSIZAFIRMCVOOl4epkAmQSERrwKOJMXkySl4rEhVSkufHDAZtyMzlDPdJweiyiN7UyRLIHsKQj5wMnowSIar5ExJQcjn5qnmqyFHlzqKL7EoQPMlphUaaL7EcGSBZiGKLzFUZGgVFSP5ElNFCVPpFORwhAeVto4uWEGwUJk3alSAVXhIR+tB7ShHTi5QkOIzpUKqEmKCPpODgReaipSUyVWl0tW6GEkWGhRBk2tq6wzrsSVqqPaGRqOmZmMTXWwqwNpbTFvbzMwtsGUMoPb2DqOmTksxK2xZLyhgck1XtzVIuw22zNszeXJvH0i7rR1G9gVlf/v+CRMnWaPYDgA74gwO0j2znAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMS0wNFQxODo1NjowNSswMTowME2yC4wAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDEtMDRUMTg6NTY6MDUrMDE6MDA877MwAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC">


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="https://jenil.github.io/bulmaswatch/flatly/bulmaswatch.min.css"> 
    <link rel="stylesheet" href="https://zeroasterisk.com/css/landing.css">   
    
    
</head>


<body>
    <header>
  <nav class="nav has-shadow">
<div class="nav-left">
    <a class="nav-item" href="https://zeroasterisk.com/">
        <img src="https://zeroasterisk.com/img/logo-zeroasterisk-on-blue.png" alt="Zeroasterisk | Alan Blount">
    </a>
</div>

<div class="nav-center">
    

    <a class="nav-item" target="blank" href="https://github.com/zeroasterisk">
        <span class="icon">
            <i class="fa fa-github"></i>
          </span>
    </a>
    
    

    <a class="nav-item" target="blank" href="https://twitter.com/zeroasterisk">
        <span class="icon">
            <i class="fa fa-twitter"></i>
          </span>
    </a>
    
</div>



<span class="nav-toggle">
        <span></span>
<span></span>
<span></span>
</span>



<div class="nav-right nav-menu" itemscope itemtype="http://schema.org/SiteNavigationElement">
        
        
        <a itemprop="url" class="nav-item is-tab " href="https://zeroasterisk.com/about/"><span itemprop="name">Abouts</span></a>
        
        <a itemprop="url" class="nav-item is-tab " href="https://zeroasterisk.com/post/"><span itemprop="name">Posts</span></a>
        
</div>
</nav>

</header>
    <main>
  <header>
    <h1>Beforesave</h1>
  </header>
  
    <div class="column is-full-desktop" itemscope itemtype="http://schema.org/CreativeWork">
    <h1 class="blog-timestamp">
        
        <h1 class="">
        <span class="icon">
  <i class="fa fa-clock-o" aria-hidden="true"></i>
</span>
<span>1 minute read</span>
<span class="icon">
 <i class="fa fa-pencil" aria-hidden="true"></i>
</span>

  Published: <time datetime="2010-02-19T02:59:45&#43;00:00">19 Feb, 2010</time>


        </h1>
        
    </h1>
    <h1 class="title">
        <a href="https://zeroasterisk.com/2010/02/18/cakephp-beforesave-gotcha-this-__exists/" itemprop="headline">CakePHP beforeSave() gotcha: need to set $this-&gt;__exists to true if setting a primary key</a>
    </h1>
    
    <h2 class="content" itemprop="description">
        I added an update to CakePHP Book: beforeSave()
 Also, if you add a primary key which would turn an &#8220;insert&#8221; into an &#8220;update&#8221; within beforeSave() you&#8217;ll need to set $this-&gt;__exists = true;&#8230; the call to $this-&gt;exists(); happens in model.php before the callback to beforeSave().
function beforeSave() { if (!isset($this-&gt;data[$this-&gt;name]['id']) && isset($this-&gt;data[$this-&gt;name]['unique_field'])) { $found = $this-&gt;find("first",array( "recursive" =&gt; -1, "fields" =&gt; array("id"), "conditions" =&gt; array("unique_field" =&gt; $this-&gt;data[$this-&gt;name]['unique_field']))); if (!empty($found) && isset($found[$this-&gt;name]['id'])) { $this-&gt;id = $this-&gt;data[$this-&gt;name]['id'] = $found[$this-&gt;name]['id']; $this-&gt;__exists = true; } } return parent::beforeSave(); }  That&#8217;s been confusing me a bit recently &#8211; setting the ID of a row within beforesave() should change the save to an update, but it was trying to insert with a specified ID and thus, failing&#8230; glad to have a simple solution that makes sense&#8230; hope that helps someone else&#8230;
    </h2>
</div>
<div class="button">
    <a href="https://zeroasterisk.com/2010/02/18/cakephp-beforesave-gotcha-this-__exists/" itemprop="url">Read Moreâ€¦</a>
</div>
  
</main>
    <footer>
  <div class="tabs">
    <p class="control">
        
    </p>
    <p class="control">
        <a class="button">
           Page 1 of 1
        </a>
    </p>
    <p class="control">
        
    </p>
</div>
  
<footer class="footer">
    <div class="container">
        <div class="content has-text-centered">
            <p>
              &copy;
              <a rel="noopener" href="https://alanblount.com/">
                Alan Blount
              </a>
              &middot;
              For more nerdy stuff checkout
              <a rel="noopener" href="https://code.zeroasterisk.com/">code.zeroasterisk.com</a>
              <em class="muted">~</em>
              <a target="_blank" rel="noopener" href="https://github.com/zeroasterisk/">
                <i class="fa fa-github"></i>
              </a>
            </p>
        </div>
    </div>
</footer>



</footer>

    <script async type="text/javascript" src="https://zeroasterisk.com/js/bulma.js"></script>
    <script async type="text/javascript"  src="https://zeroasterisk.com/js/clipboard.min.js"></script>
    <script async type="text/javascript"  src="https://zeroasterisk.com/js/clip.js"></script>
</body>

</html>