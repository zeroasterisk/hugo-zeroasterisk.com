<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta name="generator" content="Hugo 0.26" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> A CakePHP gotcha for migrating from 1.1 to 1.2&#43; on Model-&gt;create() </title>

     
      
    
    
    
    
    

  <meta name="author" content="alan">

 
    <meta property="og:title" content="A CakePHP gotcha for migrating from 1.1 to 1.2&#43; on Model-&gt;create()" />
<meta property="og:description" content="I reported this as a ticket, but as it turns out, it&#8217;s a design choice.. but it&#8217;s enough of a gotcha that I thought I should report it.
What happened The $this-&gt;ModelName-&gt;create() set the defaults for the next save, which is what I would expect. But on my database there&#8217;s a default value set for the &#8216;created&#8217; field (the standard for datetime columns in PHPmyAdmin) as well as the &#8216;modified&#8217; and &#8216;updated&#8217; fields." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zeroasterisk.com/2009/11/30/a-cakephp-gotcha-for-migrating-from-1-1-to-1-2-on-model-create/" />



<meta property="article:published_time" content="2009-11-30T16:15:28&#43;00:00"/>
<meta property="article:modified_time" content="2009-11-30T16:15:28&#43;00:00"/>










 
    



  <meta property="og:image" content="https://en.gravatar.com/userimage/831761/080d157cba7201fa2d89172617f6b7bb.jpg?size=200">

 
    
     
    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-2011466-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>
 
    
    
    <link rel="canonical" href="https://zeroasterisk.com/2009/11/30/a-cakephp-gotcha-for-migrating-from-1-1-to-1-2-on-model-create/">   <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABwlBMVEUAAAA/3MUK07UJ0rRk6NkC0rMAw5sAx6Ic1rs/3MYAlU0E0rQAhjMAyKIAiTkM07UJ07UAhC8m2L4o2L5O4Msn2L4AzKoAzq0128Mo2b8F0rQE0rMu2cAt2cAA0bI228MA0LAAy6kr2b8Q1LcF0rMH0rUAxp4t2b8c1ros2b8P1LcAzKsAzq4528Q02sIM07YAfyg93cUD0rMA0LEA0bFK4c0M1LcL07Uv2sEAzawY1rlJ4c0w2sEAzKkY1rqr+PQN07Yj170G0rQI07UF0bMt2cAF0rMC0bIL07UF0bMs2cAF0rMA0bIC0bIL07UF0rMA0bIA0bIA0bIO1LYr2b8N07Yp2L4F0rMF0rQJ07UA0bIC0bMA0bIH0rQK07UD0bMA0LAF0rMAyqYE0rMA0bIS1Lg228ID0bMM07YS1LcI07QL07UJ07UC0bMM07YG0rMS1Lc328IR1LcC0bIK07UM07Yo2L4P1LcL07UD0rMD0rMD0rMB0bIH0rQ23MMQ1LcD0rMN1LYB0LAJ0rQ33MMG0bMP1bgD0rMN07YH0rQH0rQ33MQF0rMD0rMN1LYo2L4F0rQG0rSA6tsA0bIB0bL////yxqscAAAAk3RSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgnDXAUItvZKBAi6+vpMuf3++wEIAQcEBFn5AgR9UwMEoQLD/AEH4AIdAzha+UMEAQcc9AM4CAFSA9IC+4AEAc8yAwIEBAHOMQOBBLfLMAnFlAJNsa0LAAAAAWJLR0SVCGB6gwAAAAd0SU1FB+EBBBI4BduZ4woAAAF5SURBVDjLY2CAAUYmZgcWRydnVhc2dg4GTMAJlOdydZvs7sHtiU0FSJ7Hy3uyz2RfP24XNl4OLPJ8Xv5A+YBAsAo0M2DyQZMnY1fBL+AgCJXHrkIoWDgEJo9NhUioaBhCHqoiXExcAqZAMkIqckrU5MkoKqSjZeAmyMbIxSIZAFIRMCVOOl4epkAmQSERrwKOJMXkySl4rEhVSkufHDAZtyMzlDPdJweiyiN7UyRLIHsKQj5wMnowSIar5ExJQcjn5qnmqyFHlzqKL7EoQPMlphUaaL7EcGSBZiGKLzFUZGgVFSP5ElNFCVPpFORwhAeVto4uWEGwUJk3alSAVXhIR+tB7ShHTi5QkOIzpUKqEmKCPpODgReaipSUyVWl0tW6GEkWGhRBk2tq6wzrsSVqqPaGRqOmZmMTXWwqwNpbTFvbzMwtsGUMoPb2DqOmTksxK2xZLyhgck1XtzVIuw22zNszeXJvH0i7rR1G9gVlf/v+CRMnWaPYDgA74gwO0j2znAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMS0wNFQxODo1NjowNSswMTowME2yC4wAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDEtMDRUMTg6NTY6MDUrMDE6MDA877MwAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC">


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="https://jenil.github.io/bulmaswatch/flatly/bulmaswatch.min.css"> 
    <link rel="stylesheet" href="https://zeroasterisk.com/css/landing.css"> 
<link rel="stylesheet" href="https://zeroasterisk.com/css/blog-post.css"> 
<link rel="stylesheet" href="https://zeroasterisk.com/css/code-highlighting/dark.css">
<link rel="stylesheet" href="https://zeroasterisk.com/css/custom.css"> 
 
    
    
</head>


<body>
    <header> <nav class="nav has-shadow">
<div class="nav-left">
    <a class="nav-item" href="https://zeroasterisk.com/">
        <img src="https://zeroasterisk.com/img/logo-zeroasterisk-on-blue.png" alt="Zeroasterisk | Alan Blount">
    </a>
</div>

<div class="nav-center">
    

    <a class="nav-item" target="blank" href="https://github.com/zeroasterisk">
        <span class="icon">
            <i class="fa fa-github"></i>
          </span>
    </a>
    
    

    <a class="nav-item" target="blank" href="https://twitter.com/zeroasterisk">
        <span class="icon">
            <i class="fa fa-twitter"></i>
          </span>
    </a>
    
</div>



<span class="nav-toggle">
        <span></span>
<span></span>
<span></span>
</span>



<div class="nav-right nav-menu" itemscope itemtype="http://schema.org/SiteNavigationElement">
        
        
        <a itemprop="url" class="nav-item is-tab " href="https://zeroasterisk.com/about/"><span itemprop="name">Abouts</span></a>
        
        <a itemprop="url" class="nav-item is-tab  is-active" href="https://zeroasterisk.com/post/"><span itemprop="name">Posts</span></a>
        
</div>
</nav>
 </header>
    <main>

<div class="container" itemscope itemtype="http://schema.org/BlogPosting">
     
<meta itemprop="name" content="A CakePHP gotcha for migrating from 1.1 to 1.2&#43; on Model-&gt;create()">
<meta itemprop="description" content="I reported this as a ticket, but as it turns out, it&#8217;s a design choice.. but it&#8217;s enough of a gotcha that I thought I should report it.
What happened The $this-&gt;ModelName-&gt;create() set the defaults for the next save, which is what I would expect. But on my database there&#8217;s a default value set for the &#8216;created&#8217; field (the standard for datetime columns in PHPmyAdmin) as well as the &#8216;modified&#8217; and &#8216;updated&#8217; fields.">


<meta itemprop="dateModified" content="2009-11-30T16:15:28&#43;00:00" />
<meta itemprop="wordCount" content="216">



<meta itemprop="keywords" content="" />

    <section class="hero is-primary is-medium">
        <div class="hero-body">
            <div class="container has-text-centered">
                <h1 class="title is-2" itemprop="headline">
                    A CakePHP gotcha for migrating from 1.1 to 1.2&#43; on Model-&gt;create()
                </h1>
                
            </div>
        </div>
    </section>
    <section class="section blog">
        <div class="container">
            <p><span class="icon">
  <i class="fa fa-clock-o" aria-hidden="true"></i>
</span>
<span>2 minute read</span>
<span class="icon">
 <i class="fa fa-pencil" aria-hidden="true"></i>
</span>

  Published: <time datetime="2009-11-30T16:15:28&#43;00:00">30 Nov, 2009</time>

</p>
            <div class="columns is-mobile">
                <div class="column">

                    <div class="content blog-post section" itemprop="articleBody">

                        
                        <hr>
                        

<p>I reported this as a <a href="http://code.cakephp.org/tickets/view/143">ticket</a>, but as it turns out, it&#8217;s a design choice.. but it&#8217;s enough of a gotcha that I thought I should report it.</p>

<h4 id="what-happened">What happened</h4>

<p>The $this-&gt;ModelName-&gt;create() set the defaults for the next save, which is what I would expect. But on my database there&#8217;s a default value set for the &#8216;created&#8217; field (the standard for datetime columns in PHPmyAdmin) as well as the &#8216;modified&#8217; and &#8216;updated&#8217; fields.</p>

<p>So when the $this-&gt;ModelName-&gt;create() function ran, it populated the &#8216;created&#8217; and &#8216;updated&#8217; and &#8216;modified&#8217; fields based on their default values in MySQL; which is &#8220;0000-00-00 00:00:00&#8243;.</p>

<p>Subsequently, when I ran $this-&gt;ModelName-&gt;save($dataWithoutCreated); the &#8216;created&#8217; and &#8216;updated&#8217; and &#8216;modified&#8217; fields were not defaulting to the current timestamp when they were not set by the $data passed into save&#8230; since they already had a &#8220;valid&#8221; value.</p>

<h4 id="the-solution">The Solution</h4>

<p>Of course you can modify your model with a beforeSave() code to strip those off, but the &#8220;real&#8221; solution recommended by Mark Story is to change the default value of those fields in the database to NULL. This is something that sounded foreign to me, since PHPMyAdmin defaults to &#8220;0000-00-00&#8243; for date/time fields, but it seems to work fine and I usually will defer to recommendations of the CakePHP core devs (and usually am happy I&#8217;ve done so).</p>

                    </div>
                    <div class="title is-4">
                        <p>
  Published
  
    
      by <span itemprop="author">alan</span>
    
  
  <time datetime="2009-11-30T16:15:28&#43;00:00">
    30 Nov, 2009
  </time>
  
    in <span itemprop="articleSection"><a href="https://zeroasterisk.com/categories/cakephp/">cakephp</a></span>
  
  
  using <span itemprop="wordCount">216</span> words.
</p>

                        



                    </div>
          
                    
                    <article>

                        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zeroasterisk" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    </article>
                    
            
                </div>
            </div>
        
        </div>
    </section>
</div>

</main>
    <footer> 
<footer class="footer">
    <div class="container">
        <div class="content has-text-centered">
            <p>
              &copy;
              <a rel="noopener" href="https://alanblount.com/">
                Alan Blount
              </a>
              &middot;
              For more nerdy stuff checkout
              <a rel="noopener" href="https://code.zeroasterisk.com/">code.zeroasterisk.com</a>
              <em class="muted">~</em>
              <a target="_blank" rel="noopener" href="https://github.com/zeroasterisk/">
                <i class="fa fa-github"></i>
              </a>
            </p>
        </div>
    </div>
</footer>


 </footer>

    <script async type="text/javascript" src="https://zeroasterisk.com/js/bulma.js"></script>
    <script async type="text/javascript"  src="https://zeroasterisk.com/js/clipboard.min.js"></script>
    <script async type="text/javascript"  src="https://zeroasterisk.com/js/clip.js"></script>
</body>

</html>